(window["webpackJsonpmobile-steps"]=window["webpackJsonpmobile-steps"]||[]).push([[0],{103:function(e,t,a){},104:function(e,t,a){},105:function(e,t,a){},106:function(e,t,a){},107:function(e,t,a){},108:function(e,t,a){},109:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(51),r=a.n(o),s=(a(63),a(57)),i=a(52),u="user",l='vr"(Jwb+Gu.aev7V';function d(e){var t=e.setToken;Object(n.useEffect)(function(){var e=localStorage.getItem(u);t(e)});var a=Object(n.useRef)(null),o=Object(n.useRef)(null);return c.a.createElement("form",{onSubmit:function(){var e=Object(i.a)(["current","value"],a),n=Object(i.a)(["current","value"],o);"proto"===e&&"taunt1"===n&&(localStorage.setItem(u,l),t(l))}},c.a.createElement("input",{ref:a}),c.a.createElement("input",{ref:o,type:"password"}),c.a.createElement("button",{type:"submit"},"\u0412\u043e\u0439\u0442\u0438"))}var m,O,p,f=a(4),b=a(5),I=a(53),E=a(54),y=a(117),v=a(110),h=a(115),A=a(112),N=a(18),g=a(7),T=a.n(g),C=(a(103),{IN_PLAY:"IN_PLAY",WIN:"WIN",LOSE:"LOSE"}),j=(m={},Object(f.a)(m,C.IN_PLAY,{text:""}),Object(f.a)(m,C.WIN,{text:"\u041f\u043e\u0431\u0435\u0434\u0430!"}),Object(f.a)(m,C.LOSE,{text:"\u041f\u043e\u0440\u0430\u0436\u0435\u043d\u0438\u0435 :("}),m),_={NOTHING:"NOTHING",FILLER:"FILLER",BOSS_ATTACK:"BOSS_ATTACK",PLAYER_ATTACK:"PLAYER_ATTACK"},S=(O={},Object(f.a)(O,_.NOTHING,{text:"\u041f\u0443\u0441\u0442\u043e",color:"lightgrey"}),Object(f.a)(O,_.FILLER,{text:"\u0424\u0438\u043b\u043b\u0435\u0440",color:"darkblue"}),Object(f.a)(O,_.BOSS_ATTACK,{text:"\u0411\u043e\u0441\u0441 \u0430\u0442\u0430\u043a\u0443\u0435\u0442",color:"#ff2fad"}),Object(f.a)(O,_.PLAYER_ATTACK,{text:"\u0418\u0433\u0440\u043e\u043a \u0430\u0442\u0430\u043a\u0443\u0435\u0442",color:"greenyellow"}),O),P={PLAYER_ACTION:"PLAYER_ACTION",ACTION_OUTCOME_CHOICE:"ACTION_OUTCOME_CHOICE",ACTION_OUTCOME_RESOLVE:"ACTION_OUTCOME_RESOLVE"},w=(p={},Object(f.a)(p,P.PLAYER_ACTION,{text:"\u0425\u043e\u0434 \u0418\u0433\u0440\u043e\u043a\u0430"}),Object(f.a)(p,P.ACTION_OUTCOME_CHOICE,{text:"\u0412\u044b\u0431\u043e\u0440 \u0438\u0441\u0445\u043e\u0434\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0418\u0433\u0440\u043e\u043a\u0430"}),Object(f.a)(p,P.ACTION_OUTCOME_RESOLVE,{text:"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0438\u0441\u0445\u043e\u0434\u0430\u043c\u0438 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u0418\u0433\u0440\u043e\u043a\u0430"}),p),L=a(114),k=a(116),H=a(56),x=a(113),R=a(111);function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var G={current:1,get generate(){return G.current++}};var Y,U=function(e){var t=function(){return function(e){var t=e([_.NOTHING,_.PLAYER_ATTACK])[0];return F(t)}(e)},a=Object(v.a)(t,2),n=Object(v.a)(t,2),c=e([0,1,2,3,4]),o=[F(_.NOTHING),F(_.NOTHING),F(_.NOTHING),F(_.NOTHING),F(_.NOTHING)],r=[].concat(Object(b.a)(a),Object(b.a)(n),o);return{player:{maxHP:5,damageIds:[],actionIds:[0,1]},boss:{maxHP:5,damageIds:[]},application:{possibleOutcomeIds:[],shuffledOutcomeIds:[],shuffledStepIds:c,isShowedCurrentStep:!1,openedOutcomeId:null},outcomes:{allIds:[B.id].concat(Object(b.a)(r.map(Object(R.a)("id")))),byId:r.reduce(function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(a,!0).forEach(function(t){Object(f.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},e,Object(f.a)({},t.id,t))},Object(f.a)({},B.id,B))},actions:{allIds:[0,1],byId:{0:{id:0,text:"\u041a\u0430\u0440\u0430",outcomeIds:a.map(Object(R.a)("id")),openOutcomeIds:[],move:function(){}},1:{id:1,text:"\u0429\u0438\u0442",outcomeIds:n.map(Object(R.a)("id")),openOutcomeIds:[],move:function(){}}}},steps:{allIds:[0,1,2,3,4],byId:{0:{id:0,outcomeIds:[o[0].id]},1:{id:1,outcomeIds:[o[1].id]},2:{id:2,outcomeIds:[o[2].id]},3:{id:3,outcomeIds:[o[3].id]},4:{id:4,outcomeIds:[o[4].id]}}},damages:{allIds:[],byId:{}}}};function D(e,t){t.allIds=Object(x.a)(t.allIds,[e.id]),t.byId[e.id]=e}function K(){return{id:G.generate}}var V=(Y={},Object(f.a)(Y,_.NOTHING,function(e){}),Object(f.a)(Y,_.FILLER,function(e){var t=F(_.BOSS_ATTACK,!1);D(t,e.outcomes),e.application.possibleOutcomeIds.push(t.id)}),Object(f.a)(Y,_.PLAYER_ATTACK,function(e){var t=K();e.boss.damageIds.push(t.id),D(t,e.damages)}),Object(f.a)(Y,_.BOSS_ATTACK,function(e){var t=K();e.player.damageIds.push(t.id),D(t,e.damages)}),Y),B={id:0,type:_.NOTHING,effect:V[_.NOTHING],isDisposable:!0},F=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{id:G.generate,type:e,effect:V[e],isDisposable:t}},W={playerMaxHP:function(e){return e.player.maxHP},playerCurrentHP:function(e){return e.player.maxHP-e.player.damageIds.length},playerDamageIds:function(e){return e.player.damageIds},bossMaxHP:function(e){return e.boss.maxHP},bossCurrentHP:function(e){return e.boss.maxHP-e.boss.damageIds.length},bossDamageIds:function(e){return e.boss.damageIds},shuffledOutcomes:function(e){return Object(k.a)(e.application.shuffledOutcomeIds)?[e.outcomes.byId[B.id]]:e.application.shuffledOutcomeIds.map(function(t){return e.outcomes.byId[t]})},attackActionOutcomeIds:function(e){return e.actions.byId[e.player.actionIds[0]].outcomeIds},attackActionOutcomes:function(e){return this.attackActionOutcomeIds(e).map(function(t){return e.outcomes.byId[t]})},playerAttackOutcomeIds:function(e){var t=this.attackActionOutcomeIds(e),a=this.currentOutcomeIds(e);return[].concat(Object(b.a)(t),Object(b.a)(a))},playerAttackPossibleOutcomeIds:function(e){return e.application.possibleOutcomeIds},playerAttackPossibleOutcomes:function(e){return this.playerAttackPossibleOutcomeIds(e).map(function(t){return e.outcomes.byId[t]})},currentOutcomeIds:function(e){return e.steps.byId[Object(y.a)(e.application.shuffledStepIds)].outcomeIds},currentOutcomes:function(e){return this.currentOutcomeIds(e).map(function(t){return e.outcomes.byId[t]})},defendActionOutcomeIds:function(e){return e.actions.byId[e.player.actionIds[1]].outcomeIds},bossAttackOutcomes:function(e){var t=e.player.actionIds.flatMap(function(t){return e.actions.byId[t].outcomeIds});return Object(b.a)(t)},isShowedCurrentStep:function(e){return e.application.isShowedCurrentStep},selectedOutcomeMaybe:function(e){return H.a.fromNullable(e.outcomes.byId[e.application.openedOutcomeId])},openedOutcomeId:function(e){return e.application.openedOutcomeId},currentStepValue:function(e){return Object(y.a)(e.application.shuffledStepIds)}};function J(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}Object(L.a)(A.a);var $=function(e){return Object(N.a)(W).reduce(function(t,a){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?J(a,!0).forEach(function(t){Object(f.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):J(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},t,Object(f.a)({},a,W[a].call(W,e)))},{})};a(104);function q(e){var t=e.G,a=e.chooseOutcome,n=e.resolveOutcome,o=(e.throwOff,e.phase),r=e.outcomes,s=(e.selectedOutcomeMaybe,e.stage),i=e.openedOutcomeId,u=[P.ACTION_OUTCOME_CHOICE,P.ACTION_OUTCOME_RESOLVE].includes(o),l=[P.ACTION_OUTCOME_RESOLVE].includes(o),d=(u&&1===r.length&&(r[0].id,B.id),$(t).playerAttackPossibleOutcomes),m=Object(v.a)(function(e){return F(_.FILLER)},5-d.length),O=o===P.ACTION_OUTCOME_CHOICE&&s===C.IN_PLAY;return c.a.createElement("div",null,c.a.createElement("div",{className:"possible-outcomes-panel"},d.map(function(e){return c.a.createElement(z,Object.assign({key:e.id,isOpened:e.type===_.BOSS_ATTACK,isVisible:O||e.type===_.BOSS_ATTACK},e))}),O?"+":"",m.map(function(e){return c.a.createElement(z,Object.assign({key:e.id,isOpened:!0,isVisible:O},e))})),"\u21e9",c.a.createElement("div",{className:"outcome-panel"},c.a.createElement("div",{className:"outcome-panel__container"},u&&r.map(function(e){var t=e.id,n=e.type,o=i===t;return c.a.createElement("div",{key:t,onClick:function(){return!l&&a(e)},className:T()("outcome-card",{"outcome-card_player-attack":n===_.PLAYER_ATTACK&&o,"outcome-card_boss-attack":n===_.BOSS_ATTACK&&o,"outcome-card_nothing":n===_.NOTHING&&o,"outcome-card_filler":n===_.FILLER&&o})},o?S[n].text:"")})),l&&c.a.createElement("div",{className:"outcome-panel__buttons"},c.a.createElement("button",{disabled:!1,onClick:n},"\u0414\u0430\u043b\u044c\u0448\u0435"))))}function z(e){var t=e.type,a=e.isOpened;return e.isVisible?a?c.a.createElement("div",{className:"possible-outcome",style:{background:S[t].color}}):c.a.createElement("div",{className:"possible-outcome"}):null}a(105);function Q(e){var t=e.G,a=$(t).playerDamageIds;return c.a.createElement("div",{className:"player-damage-panel"},Object(v.a)(function(e){return c.a.createElement("div",{key:e,className:"player-damage-slot"},c.a.createElement("div",{className:T()("player-damage-card",{"player-damage-card_opened":a.length>e})}))},5))}a(106);function X(e){var t=e.G,a=$(t).bossDamageIds;return c.a.createElement("div",{className:"boss-damage-panel"},Object(v.a)(function(e){return c.a.createElement("div",{key:e,className:"boss-damage-slot"},c.a.createElement("div",{className:T()("boss-damage-card",{"boss-damage-card_opened":a.length>e})}))},5))}a(107);function Z(e){var t=e.smite,a=e.phase,n=(e.shield,e.G),o=$(n),r=o.attackActionOutcomes;o.attackOpenedOutcomeIds,o.defendActionOutcomeIds;return c.a.createElement("div",{className:"player-action-panel"},c.a.createElement("div",{className:"player-action"},c.a.createElement("div",{className:"player-action__outcomes"},r.map(function(e){return c.a.createElement(ee,{key:e.id,outcome:e,isOpened:!1})})),c.a.createElement("button",{onClick:t,disabled:a!==P.PLAYER_ACTION,className:"player-action-button"},"\u041a\u0430\u0440\u0430")))}function ee(e){var t=e.outcome;return e.isOpened?c.a.createElement("div",{className:"player-action__outcome",style:{background:S[t.type].color||"white"}}):c.a.createElement("div",{className:"player-action__outcome"})}var te;a(108);function ae(e){var t=e.isShowedCurrentStep,a=e.currentOutcomes;return c.a.createElement("div",{className:"steps"},c.a.createElement("div",{className:"step"},"\u21e9"),c.a.createElement("div",{className:"step"},"\u21e9"),c.a.createElement("div",{className:"step"},"\u21e9"),c.a.createElement("div",{className:"step"},"\u21e9"),c.a.createElement("div",{className:T()("step",t&&"step_showed")},t?a.map(function(e){return c.a.createElement("div",{key:e.id,className:"step__outcome",style:{background:S[e.type].color||"white"}})}):"?"))}function ne(e){var t=e.stage,a=e.phase;return c.a.createElement("header",null,t===C.IN_PLAY?Object(N.a)(w).map(function(e){return e===a?c.a.createElement("div",{key:e,className:"phase phase_current"},w[e].text):c.a.createElement("div",{key:e,className:"phase"},w[e].text)}):j[t].text)}var ce=Object(I.Game)({setup:function(e){return U(e.random.Shuffle)},moves:{smite:function(e,t){var a,n;(a=e.application.possibleOutcomeIds).push.apply(a,Object(b.a)(W.attackActionOutcomeIds(e))),(n=e.application.possibleOutcomeIds).push.apply(n,Object(b.a)(e.steps.byId[Object(y.a)(e.application.shuffledStepIds)].outcomeIds));var c=W.playerAttackPossibleOutcomeIds(e),o=[],r=c.length;r<5&&Object(v.a)(function(){var t=F(_.FILLER,!1);D(t,e.outcomes),o.push(t.id)},5-r),e.application.shuffledOutcomeIds=t.random.Shuffle([].concat(Object(b.a)(c),o)),t.events.endPhase({next:P.ACTION_OUTCOME_CHOICE})},chooseAttackOutcome:function(e,t,a){e.application.openedOutcomeId=a.id,a.effect(e),e.application.possibleOutcomeIds=e.application.possibleOutcomeIds.filter(function(e){return e!==a.id}),t.events.endPhase({next:P.ACTION_OUTCOME_RESOLVE})},resolveActionOutcome:function(e,t){t.events.endPhase({next:P.PLAYER_ACTION})}},flow:{endGameIf:function(e){var t=e.player,a=e.boss;return a.damageIds.length>a.maxHP?C.WIN:t.damageIds.length>t.maxHP?C.LOSE:void 0},startingPhase:P.PLAYER_ACTION,phases:(te={},Object(f.a)(te,P.PLAYER_ACTION,{allowedMoves:["smite","surgeOfEnergy","shield"]}),Object(f.a)(te,P.ACTION_OUTCOME_CHOICE,{allowedMoves:["chooseAttackOutcome"],onPhaseBegin:function(e){e.application.isShowedCurrentStep=!0}}),Object(f.a)(te,P.ACTION_OUTCOME_RESOLVE,{allowedMoves:["resolveActionOutcome","throwOff"],onPhaseEnd:function(e){e.application.openedOutcomeId=null,e.application.isShowedCurrentStep=!1,e.application.shuffledOutcomeIds=[],e.application.possibleOutcomeIds=e.application.possibleOutcomeIds.filter(function(t){return!e.outcomes.byId[t].isDisposable}),e.application.shuffledStepIds=[Object(y.a)(e.application.shuffledStepIds)].concat(Object(b.a)(Object(h.a)(1,e.application.shuffledStepIds)))}}),te)}});var oe=Object(E.Client)({game:ce,board:function(e){var t=e.G,a=e.ctx,n=e.moves,o=Object(A.a)(a.gameover)?C.IN_PLAY:a.gameover,r=(n.smite,n.surgeOfEnergy,n.chooseAttackOutcome),s=n.chooseTriggerOutcome,i=n.resolveActionOutcome,u=(n.pass,n.resolveTriggerOutcome),l=n.throwOff,d=(n.shield,a.phase),m=$(t),O=m.shuffledOutcomes,p=m.isShowedCurrentStep,f=(m.currentStepValue,m.playerAspects,m.selectedOutcomeMaybe),b=(m.playerMaxHP,m.bossMaxHP,m.bossAspects,m.openedOutcomeId),I=m.currentOutcomes;return c.a.createElement("div",{className:"main-container"},c.a.createElement(ne,{stage:o,phase:d}),c.a.createElement("div",{className:"action-panel"},c.a.createElement(Z,Object.assign({},n,{G:t,phase:d})),c.a.createElement(q,{G:t,phase:d,stage:o,chooseOutcome:d===P.ACTION_OUTCOME_CHOICE?r:s,resolveOutcome:d===P.ACTION_OUTCOME_RESOLVE?i:u,outcomes:O,selectedOutcomeMaybe:f,throwOff:l,openedOutcomeId:b}),c.a.createElement(ae,{isShowedCurrentStep:p,currentOutcomes:I})),c.a.createElement("div",{className:"main-panel"},c.a.createElement(Q,{G:t}),c.a.createElement(X,{G:t})))},numPlayers:1});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(c.a.createElement(function(){var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],o=t[1];return a===l?c.a.createElement(oe,null):c.a.createElement(d,{setToken:o})},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},58:function(e,t,a){e.exports=a(109)},63:function(e,t,a){},98:function(e,t){}},[[58,1,2]]]);
//# sourceMappingURL=main.cfcdfff8.chunk.js.map