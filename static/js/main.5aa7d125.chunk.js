(window["webpackJsonpmobile-steps"]=window["webpackJsonpmobile-steps"]||[]).push([[0],{21:function(e,t,a){e.exports=a(28)},26:function(e,t,a){},27:function(e,t,a){},28:function(e,t,a){"use strict";a.r(t);var c,n=a(1),r=a.n(n),s=a(19),o=a.n(s),l=(a(26),a(5)),i=a(17),u=a(4),p=a(36),b=a(30),y=a(32),m=a(34),d=a(14),O=a(37),f=a(15),j=a(33),v=(a(27),a(29)),E={IN_PLAY:"IN_PLAY",WIN:"WIN",LOSE:"LOSE"},g={A:"A",B:"B",C:"C",D:"D"},S={HOLD:"HOLD",INVEST:"INVEST",WAIT:"WAIT"},h=new Map([[g.A,[g.B,g.C,g.D]],[g.B,[g.A,g.B,g.C,g.D]],[g.C,[g.A,g.C]],[g.D,[g.C]]]),C=function(e){var t=h.get(e),a=t.length;return t[Math.floor(Math.random()*a)]},k=(c={},Object(l.a)(c,g.A,"#6ccc6c"),Object(l.a)(c,g.B,"#9292ff"),Object(l.a)(c,g.C,"#ff8c8c"),Object(l.a)(c,g.D,"#faff7e"),c),A=function(){var e=[!0,!1];return e[Math.floor(Math.random()*e.length)]},N=0;function w(e){var t=A();return{id:N++,type:e,get stepColor(){return t?"white":k[e]},get slotColor(){return k[e]},isHidden:t}}var D=a(35),P=a(31),I=Object(D.a)(P.a),B=a(20),M="user",T='vr"(Jwb+Gu.aev7V';function L(e){var t=e.setToken;Object(n.useEffect)(function(){var e=localStorage.getItem(M);t(e)});var a=Object(n.useRef)(null),c=Object(n.useRef)(null);return r.a.createElement("form",{onSubmit:function(){var e=Object(B.a)(["current","value"],a),n=Object(B.a)(["current","value"],c);"proto"===e&&"taunt1"===n&&(localStorage.setItem(M,T),t(T))}},r.a.createElement("input",{ref:a}),r.a.createElement("input",{ref:c,type:"password"}),r.a.createElement("button",{type:"submit"},"\u0412\u043e\u0439\u0442\u0438"))}function W(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,c)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?W(a,!0).forEach(function(t){Object(l.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):W(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var _=5,H=3,V=5,Y={steps:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[w(g.A)];return t<2?a:e(t-1,[w(C(Object(v.a)("type",Object(b.a)(a))))].concat(Object(u.a)(a)))}(),playedSteps:[].concat(Object(u.a)(Object(p.a)({type:g.A},V)),Object(u.a)(Object(p.a)({type:g.B},V)),Object(u.a)(Object(p.a)({type:g.C},V)),Object(u.a)(Object(p.a)({type:g.D},V))),slots:[],prevSlots:[],lastPlayerActionTypePlayed:S.WAIT,resource:0,slotMaximum:3};var J=function(){var e,t=Object(n.useReducer)(function(e,t){var a=t.type,c=Object(b.a)(e.steps),n=Object(y.a)(e.steps),r=e.slots.length===e.slotMaximum&&e.resource>=e.slotMaximum,s=e.playedSteps.filter(function(e){return e.type===g.A}).length>=V&&n.type===g.A,o=e.playedSteps.filter(function(e){return e.type===g.B}).length>=V&&n.type===g.B,l=e.playedSteps.filter(function(e){return e.type===g.C}).length>=V&&n.type===g.C,i=e.playedSteps.filter(function(e){return e.type===g.D}).length>=V,p=[n].concat(Object(u.a)(e.slots.slice(0,e.slotMaximum-1))),d=[n,x({},n,{id:-1*(n.id+1e3)})].concat(Object(u.a)(e.slots.slice(0,e.slotMaximum-2)));switch(a){case"onHoldClicked":return x({},e,{lastPlayerActionTypePlayed:S.HOLD,slots:l?d:p,prevSlots:e.slots,steps:[w(C(c.type))].concat(Object(u.a)(Object(m.a)(1,e.steps))),playedSteps:[].concat(Object(u.a)(e.playedSteps),[n])});case"onInvestClicked":return x({},e,{lastPlayerActionTypePlayed:S.INVEST,slots:i?o?[n].concat(Object(u.a)(e.slots.filter(function(e){return e.type===g.D}))):e.slots.filter(function(e){return e.type===g.D}):o?[n]:[],prevSlots:e.slots,steps:[w(C(c.type))].concat(Object(u.a)(Object(m.a)(1,e.steps))),playedSteps:[].concat(Object(u.a)(e.playedSteps),[n]),slotMaximum:r?Math.min(e.slotMaximum+1,_):e.slotMaximum,resource:r?e.resource-e.slotMaximum:e.resource});case"onWaitClicked":return x({},e,{lastPlayerActionTypePlayed:S.WAIT,steps:[w(C(c.type))].concat(Object(u.a)(Object(m.a)(1,e.steps))),slots:o?p:e.slots,prevSlots:e.slots,playedSteps:[].concat(Object(u.a)(e.playedSteps),[n]),resource:s?e.resource:e.resource+1});default:return e}},Y),a=Object(i.a)(t,2),c=a[0],s=c.steps,o=c.playedSteps,p=c.slots,v=c.prevSlots,h=c.lastPlayerActionTypePlayed,A=c.resource,N=c.slotMaximum,D=a[1],P=Object(n.useState)(""),B=Object(i.a)(P,2),M=B[0],W=B[1],J=M===T,R=function(){var e;return v.length>=_&&h===S.INVEST?E.WIN:Object(j.a)(p.reduce(function(e,t){return x({},e,Object(l.a)({},t.type,e[t.type]+1))},(e={},Object(l.a)(e,g.A,0),Object(l.a)(e,g.B,0),Object(l.a)(e,g.C,0),Object(l.a)(e,g.D,0),e))).some(function(e){return e>=H})?E.LOSE:E.IN_PLAY}(),G=function(){D({type:"onHoldClicked"})},$=function(){D({type:"onInvestClicked"})},q=function(){D({type:"onWaitClicked"})};Object(n.useEffect)(function(){J&&document.addEventListener("keypress",function(e){switch(e.key){case"1":G();break;case"2":$();break;case"3":q()}})},[J]);var z=o.reduce(function(e,t){return x({},e,Object(l.a)({},t.type,e[t.type]+1))},(e={},Object(l.a)(e,g.A,0),Object(l.a)(e,g.B,0),Object(l.a)(e,g.C,0),Object(l.a)(e,g.D,0),e));return J?r.a.createElement("main",null,r.a.createElement("div",null,r.a.createElement("div",{className:"steps"},s.map(function(e){return r.a.createElement("div",{key:e.id,className:"step",style:{background:e.stepColor}},Object(f.a)(e.items).map(function(t){return r.a.createElement("div",{key:t,className:"step-item"},I(e.items[t])&&e.items[t])}))})),R===E.IN_PLAY&&r.a.createElement("div",{className:"action-panel"},r.a.createElement("button",{className:"action",onClick:G},"\u0417\u0430\u0445\u0432\u0430\u0442\u0438\u0442\u044c"),r.a.createElement("button",{className:"action",onClick:$},"\u0412\u043b\u043e\u0436\u0438\u0442\u044c\u0441\u044f"),r.a.createElement("button",{className:"action",onClick:q},"\u0416\u0434\u0430\u0442\u044c")),R===E.WIN&&"\u041f\u041e\u0411\u0415\u0414\u0410!",R===E.LOSE&&"\u041f\u041e\u0420\u0410\u0416\u0415\u041d\u0418\u0415!",r.a.createElement("div",{className:"slot-panel"},[].concat(Object(u.a)(p),Object(u.a)(Object(d.a)(function(e){return{id:e,slotColor:"white"}},Object(O.a)(-5,0)))).slice(0,N).map(function(e){return r.a.createElement("div",{key:e.id,className:"slot",style:{background:e.slotColor}})})),r.a.createElement("div",{className:"played-steps"},r.a.createElement("div",{className:"played-step played-step_a",style:{background:k[g.A]}},z[g.A]>=5?"\u0422\u0435\u043f\u0435\u0440\u044c \u0416\u0414\u0410\u0422\u042c \u043d\u0435 \u043f\u0440\u0438\u043d\u043e\u0441\u0438\u0442 \u0440\u0435\u0441\u0443\u0440\u0441":z[g.A]),r.a.createElement("div",{className:"played-step played-step_b",style:{background:k[g.B]}},z[g.B]>=5?"\u0422\u0435\u043f\u0435\u0440\u044c \u0421\u0418\u041d\u0418\u0419 \u0448\u0430\u0433 \u0432\u0441\u0435\u0433\u0434\u0430 \u043a\u0440\u0435\u043f\u0438\u0442\u0441\u044f":z[g.B]),r.a.createElement("div",{className:"played-step played-step_c",style:{background:k[g.C]}},z[g.C]>=5?"\u0422\u0435\u043f\u0435\u0440\u044c \u041a\u0420\u0410\u0421\u041d\u042b\u0419 \u0448\u0430\u0433 \u043a\u0440\u0435\u043f\u0438\u0442\u0441\u044f \u0434\u0432\u0430\u0436\u0434\u044b":z[g.C]),r.a.createElement("div",{className:"played-step played-step_d",style:{background:k[g.D]}},z[g.D]>=5?"\u0422\u0435\u043f\u0435\u0440\u044c \u0416\u0401\u041b\u0422\u042b\u0419 \u0448\u0430\u0433 \u043d\u0435\u043b\u044c\u0437\u044f \u0441\u0431\u0440\u043e\u0441\u0438\u0442\u044c":z[g.D]))),r.a.createElement("div",null,r.a.createElement("div",{className:"player-info"},A))):r.a.createElement(L,{setToken:W})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[21,1,2]]]);
//# sourceMappingURL=main.5aa7d125.chunk.js.map