(window["webpackJsonpmobile-steps"]=window["webpackJsonpmobile-steps"]||[]).push([[0],{21:function(e,t,a){e.exports=a(28)},26:function(e,t,a){},27:function(e,t,a){},28:function(e,t,a){"use strict";a.r(t);var n,c=a(1),r=a.n(c),s=a(18),o=a.n(s),l=(a(26),a(5)),i=a(4),p=a(16),u=a(30),m=a(32),y=a(33),d=a(14),b=a(35),f=a(20),O=(a(27),a(29)),j={IN_PLAY:"IN_PLAY",WIN:"WIN",LOSE:"LOSE"},v={A:"A",B:"B",C:"C",D:"D"},E={HOLD:"HOLD",INVEST:"INVEST",WAIT:"WAIT"},g=new Map([[v.A,[v.B,v.C,v.D]],[v.B,[v.A,v.B,v.C,v.D]],[v.C,[v.A,v.C]],[v.D,[v.C]]]),h=function(e){var t=g.get(e),a=t.length;return t[Math.floor(Math.random()*a)]},S=(n={},Object(l.a)(n,v.A,"#6ccc6c"),Object(l.a)(n,v.B,"#9292ff"),Object(l.a)(n,v.C,"#ff8c8c"),Object(l.a)(n,v.D,"#faff7e"),n),k=function(){var e=[!0,!1];return e[Math.floor(Math.random()*e.length)]},C=0;function N(e){var t=k();return{id:C++,type:e,get stepColor(){return t?"white":S[e]},get slotColor(){return S[e]},isHidden:t}}var A=a(34),w=a(31),P=Object(A.a)(w.a),I=a(19),D="user",M='vr"(Jwb+Gu.aev7V';function T(e){var t=e.setToken;Object(c.useEffect)(function(){var e=localStorage.getItem(D);t(e)});var a=Object(c.useRef)(null),n=Object(c.useRef)(null);return r.a.createElement("form",{onSubmit:function(){var e=Object(I.a)(["current","value"],a),c=Object(I.a)(["current","value"],n);"proto"===e&&"taunt1"===c&&(localStorage.setItem(D,M),t(M))}},r.a.createElement("input",{ref:a}),r.a.createElement("input",{ref:n,type:"password"}),r.a.createElement("button",{type:"submit"},"\u0412\u043e\u0439\u0442\u0438"))}function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(a,!0).forEach(function(t){Object(l.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var W={steps:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[N(v.A)];return t<2?a:e(t-1,[N(h(Object(O.a)("type",Object(u.a)(a))))].concat(Object(i.a)(a)))}(),playedSteps:[],slots:[],prevSlots:[],lastPlayerActionTypePlayed:E.WAIT,resource:0,slotMaximum:3},x=5;var _=function(){var e,t=Object(c.useReducer)(function(e,t){var a=t.type,n=Object(u.a)(e.steps),c=Object(m.a)(e.steps),r=e.slots.length===e.slotMaximum&&e.resource>=e.slotMaximum,s=e.playedSteps.filter(function(e){return e.type===v.A}).length>=5&&c.type===v.A,o=e.playedSteps.filter(function(e){return e.type===v.B}).length>=5&&c.type===v.B,l=e.playedSteps.filter(function(e){return e.type===v.C}).length>=5&&c.type===v.C,p=e.playedSteps.filter(function(e){return e.type===v.D}).length>=5,d=[c].concat(Object(i.a)(e.slots.slice(0,e.slotMaximum-1))),b=[c,L({},c,{id:-1*(c.id+1e3)})].concat(Object(i.a)(e.slots.slice(0,e.slotMaximum-2)));switch(a){case"onHoldClicked":return L({},e,{lastPlayerActionTypePlayed:E.HOLD,slots:l?b:d,prevSlots:e.slots,steps:[N(h(n.type))].concat(Object(i.a)(Object(y.a)(1,e.steps))),playedSteps:[].concat(Object(i.a)(e.playedSteps),[c])});case"onInvestClicked":return L({},e,{lastPlayerActionTypePlayed:E.INVEST,slots:p?o?[c].concat(Object(i.a)(e.slots.filter(function(e){return e.type===v.D}))):e.slots.filter(function(e){return e.type===v.D}):o?[c]:[],prevSlots:e.slots,steps:[N(h(n.type))].concat(Object(i.a)(Object(y.a)(1,e.steps))),playedSteps:[].concat(Object(i.a)(e.playedSteps),[c]),slotMaximum:r?Math.min(e.slotMaximum+1,x):e.slotMaximum,resource:r?e.resource-e.slotMaximum:e.resource});case"onWaitClicked":return L({},e,{lastPlayerActionTypePlayed:E.WAIT,steps:[N(h(n.type))].concat(Object(i.a)(Object(y.a)(1,e.steps))),slots:o?d:e.slots,prevSlots:e.slots,playedSteps:[].concat(Object(i.a)(e.playedSteps),[c]),resource:s?e.resource:e.resource+1});default:return e}},W),a=Object(p.a)(t,2),n=a[0],s=n.steps,o=n.playedSteps,O=n.slots,g=n.prevSlots,k=n.lastPlayerActionTypePlayed,C=n.resource,A=n.slotMaximum,w=a[1],I=Object(c.useState)(""),D=Object(p.a)(I,2),B=D[0],_=D[1],H=B===M,V=g.length>=x&&k===E.INVEST?j.WIN:O.length===A&&O.every(function(e){return e.type===O[0].type})?j.LOSE:j.IN_PLAY,Y=function(){w({type:"onHoldClicked"})},J=function(){w({type:"onInvestClicked"})},R=function(){w({type:"onWaitClicked"})};Object(c.useEffect)(function(){H&&document.addEventListener("keypress",function(e){switch(e.key){case"1":Y();break;case"2":J();break;case"3":R()}})},[H]);var G=o.reduce(function(e,t){return L({},e,Object(l.a)({},t.type,e[t.type]+1))},(e={},Object(l.a)(e,v.A,0),Object(l.a)(e,v.B,0),Object(l.a)(e,v.C,0),Object(l.a)(e,v.D,0),e));return H?r.a.createElement("main",null,r.a.createElement("div",null,r.a.createElement("div",{className:"steps"},s.map(function(e){return r.a.createElement("div",{key:e.id,className:"step",style:{background:e.stepColor}},Object(f.a)(e.items).map(function(t){return r.a.createElement("div",{key:t,className:"step-item"},P(e.items[t])&&e.items[t])}))})),V===j.IN_PLAY&&r.a.createElement("div",{className:"action-panel"},r.a.createElement("button",{className:"action",onClick:Y},"\u0417\u0430\u0445\u0432\u0430\u0442\u0438\u0442\u044c"),r.a.createElement("button",{className:"action",onClick:J},"\u0412\u043b\u043e\u0436\u0438\u0442\u044c\u0441\u044f"),r.a.createElement("button",{className:"action",onClick:R},"\u0416\u0434\u0430\u0442\u044c")),V===j.WIN&&"\u041f\u041e\u0411\u0415\u0414\u0410!",V===j.LOSE&&"\u041f\u041e\u0420\u0410\u0416\u0415\u041d\u0418\u0415!",r.a.createElement("div",{className:"slot-panel"},[].concat(Object(i.a)(O),Object(i.a)(Object(d.a)(function(e){return{id:e,slotColor:"white"}},Object(b.a)(-5,0)))).slice(0,A).map(function(e){return r.a.createElement("div",{key:e.id,className:"slot",style:{background:e.slotColor}})})),r.a.createElement("div",{className:"played-steps"},r.a.createElement("div",{className:"played-step played-step_a",style:{background:S[v.A]}},G[v.A]>=5?"\u0422\u0435\u043f\u0435\u0440\u044c \u0416\u0414\u0410\u0422\u042c \u043d\u0435 \u043f\u0440\u0438\u043d\u043e\u0441\u0438\u0442 \u0440\u0435\u0441\u0443\u0440\u0441":G[v.A]),r.a.createElement("div",{className:"played-step played-step_b",style:{background:S[v.B]}},G[v.B]>=5?"\u0422\u0435\u043f\u0435\u0440\u044c \u0421\u0418\u041d\u0418\u0419 \u0448\u0430\u0433 \u0432\u0441\u0435\u0433\u0434\u0430 \u043a\u0440\u0435\u043f\u0438\u0442\u0441\u044f":G[v.B]),r.a.createElement("div",{className:"played-step played-step_c",style:{background:S[v.C]}},G[v.C]>=5?"\u0422\u0435\u043f\u0435\u0440\u044c \u041a\u0420\u0410\u0421\u041d\u042b\u0419 \u0448\u0430\u0433 \u043a\u0440\u0435\u043f\u0438\u0442\u0441\u044f \u0434\u0432\u0430\u0436\u0434\u044b":G[v.C]),r.a.createElement("div",{className:"played-step played-step_d",style:{background:S[v.D]}},G[v.D]>=5?"\u0422\u0435\u043f\u0435\u0440\u044c \u0416\u0401\u041b\u0422\u042b\u0419 \u0448\u0430\u0433 \u043d\u0435\u043b\u044c\u0437\u044f \u0441\u0431\u0440\u043e\u0441\u0438\u0442\u044c":G[v.D]))),r.a.createElement("div",null,r.a.createElement("div",{className:"player-info"},C))):r.a.createElement(T,{setToken:_})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[21,1,2]]]);
//# sourceMappingURL=main.49cf9210.chunk.js.map